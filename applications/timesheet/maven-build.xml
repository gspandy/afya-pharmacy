<?xml version="1.0" encoding="UTF-8"?>

<!-- ====================================================================== -->
<!-- Ant build file (http://ant.apache.org/) for Ant 1.6.2 or above.        -->
<!-- ====================================================================== -->

<!-- ====================================================================== -->
<!-- ===================== - DO NOT EDIT THIS FILE! - ===================== -->
<!-- ====================================================================== -->
<!--                                                                        -->
<!-- Any modifications will be overwritten.                                 -->
<!--                                                                        -->
<!-- Generated by Maven Ant Plugin on 10/1/14 4:41 PM                       -->
<!-- See: http://maven.apache.org/plugins/maven-ant-plugin/                 -->
<!--                                                                        -->
<!-- ====================================================================== -->

<project name="timesheet-from-maven" default="package" basedir=".">

    <!-- ====================================================================== -->
    <!-- Build environment properties                                           -->
    <!-- ====================================================================== -->

    <property file="${user.home}/.m2/maven.properties"/>
    <property file="maven-build.properties"/>

    <property name="maven.build.finalName" value="timesheet"/>
    <property name="maven.build.dir" value="target"/>
    <property name="maven.build.outputDir" value="${maven.build.dir}/classes"/>
    <property name="maven.build.srcDir.0" value="src/main/java"/>
    <property name="maven.build.resourceDir.0" value="src/main/resources"/>
    <property name="maven.build.resourceDir.1" value="src/test/resources"/>
    <property name="maven.build.resourceDir.2" value="src/integrationtest/resources"/>
    <property name="maven.build.testOutputDir" value="${maven.build.dir}/test-classes"/>
    <property name="maven.build.testDir.0" value="src/test/java"/>
    <property name="maven.build.testResourceDir.0" value="src/test/resources"/>
    <property name="maven.test.reports" value="${maven.build.dir}/test-reports"/>
    <property name="maven.reporting.outputDirectory" value="${maven.build.dir}/site"/>

    <property name="maven.repo.local" value="${user.home}/.m2/repository"/>
    <property name="maven.settings.offline" value="false"/>
    <property name="maven.settings.interactiveMode" value="true"/>
    <property name="src.dir"     value="src/main/java"/>
    <property name="build.dir"   value="build"/>
    <property name="classes.dir" value="${build.dir}/classes"/>
    <property name="jar.dir"     value="${build.dir}/jar"/>
    <property name="main-class"  value="com.zpc.timesheet.utility.EntityEngineXMLParser"/>

    <!-- ====================================================================== -->
    <!-- Defining classpaths                                                    -->
    <!-- ====================================================================== -->

    <path id="build.classpath">
        <fileset dir="${basedir}/lib/" includes="*.jar"/>
        <fileset dir="${basedir}/sme-lib/" includes="*.jar"/>
    </path>
    <path id="build.test.classpath">
        <fileset dir="${basedir}/lib/" includes="*.jar"/>
        <fileset dir="${basedir}/sme-lib/" includes="*.jar"/>
    </path>

    <!-- ====================================================================== -->
    <!-- Cleaning up target                                                     -->
    <!-- ====================================================================== -->

    <target name="clean" description="Clean the output directory">
	    <delete dir="../../hot-deploy/timesheet/webapp/timesheet"/>
        <delete dir="${maven.build.dir}"/>
        <delete dir="${build.dir}"/>
    </target>

    <!-- ====================================================================== -->
    <!-- Compilation target                                                     -->
    <!-- ====================================================================== -->
    <target name="compile" description="Compile the code">
        <copy file="../../framework/entity/config/entityengine.xml" todir="../../applications/timesheet/src/main/resources" overwrite="true"/>
        <antcall target="runjarforparsingentityenginexml"/>
        <mkdir dir="${maven.build.outputDir}"/>
        <javac destdir="${maven.build.outputDir}"
               nowarn="false"
               debug="true"
               optimize="true"
               deprecation="false"
               target="1.7"
               verbose="false"
               fork="false"
               memoryMaximumSize="512m"
               memoryInitialSize="512m"
               source="1.7">
            <src>
                <pathelement location="${maven.build.srcDir.0}"/>
            </src>
            <classpath refid="build.classpath"/>
        </javac>
        <copy todir="${maven.build.outputDir}">
            <fileset dir="${maven.build.resourceDir.0}"/>
        </copy>
        <copy todir="${maven.build.outputDir}">
            <fileset dir="${maven.build.resourceDir.1}"/>
        </copy>
    </target>

    <!-- ====================================================================== -->
    <!-- Test-compilation target                                                -->
    <!-- ====================================================================== -->

    <target name="compile-tests"
            depends="compile"
            description="Compile the test code"
            unless="maven.test.skip">
        <mkdir dir="${maven.build.testOutputDir}"/>
        <javac destdir="${maven.build.testOutputDir}"
               nowarn="false"
               debug="true"
               optimize="true"
               deprecation="false"
               target="1.7"
               verbose="false"
               fork="false"
               memoryMaximumSize="512m"
               memoryInitialSize="512m"
               source="1.7">
            <src>
                <pathelement location="${maven.build.testDir.0}"/>
            </src>
            <classpath>
                <path refid="build.test.classpath"/>
                <pathelement location="${maven.build.outputDir}"/>
            </classpath>
        </javac>
        <copy todir="${maven.build.testOutputDir}">
            <fileset dir="${maven.build.testResourceDir.0}"/>
        </copy>
    </target>


    <!-- ====================================================================== -->
    <!-- Javadoc target                                                         -->
    <!-- ====================================================================== -->

    <target name="javadoc" description="Generates the Javadoc of the application">
        <javadoc sourcepath="${maven.build.srcDir.0}"
                 packagenames="*"
                 destdir="${maven.reporting.outputDirectory}/apidocs"
                 access="protected"
                 old="false"
                 verbose="false"
                 version="true"
                 use="true"
                 author="true"
                 splitindex="false"
                 nodeprecated="false"
                 nodeprecatedlist="false"
                 notree="false"
                 noindex="false"
                 nohelp="false"
                 nonavbar="false"
                 serialwarn="false"
                 charset="ISO-8859-1"
                 linksource="false"
                 breakiterator="false"/>
    </target>

    <!-- ====================================================================== -->
    <!-- Package target                                                         -->
    <!-- ====================================================================== -->

    <target name="package" depends="compile" description="Package the application">
        <mkdir dir="${maven.build.dir}/${maven.build.finalName}/WEB-INF/lib"/>
        <copy todir="${maven.build.dir}/${maven.build.finalName}/WEB-INF/lib">
            <fileset dir="lib"/>
        </copy>
        <war destfile="${maven.build.dir}/${maven.build.finalName}.war"
             compress="true"
             webxml="src/main/webapp/WEB-INF/web.xml">
            <lib dir="${maven.build.dir}/${maven.build.finalName}/WEB-INF/lib"/>
            <classes dir="${maven.build.outputDir}"/>
            <fileset dir="src/main/webapp"
                     excludes="WEB-INF/web.xml"/>
        </war>
    </target>

    <!-- ====================================================================== -->
    <!-- A dummy target for the package named after the type it creates         -->
    <!-- ====================================================================== -->

    <target name="war" depends="package" description="Builds the war for the application"/>

    <target name="explodedwar" depends="war">
        <unzip src="${maven.build.dir}/${maven.build.finalName}.war" dest="${maven.build.dir}/${maven.build.finalName}" overwrite="true"/>
    </target>


    <target name="compileparser">
        <mkdir dir="${build.dir}"/>
        <mkdir dir="${classes.dir}"/>
        <javac destdir="${classes.dir}" srcdir="${maven.build.srcDir.0}">
            <include name="com/zpc/timesheet/utility/EntityEngineXMLParser.java"/>
            <!--<include name="com/zpc/timesheet/utility/ReplaceSpecialCharacters.java"/>-->
            <classpath refid="build.classpath"/>
        </javac>
    </target>

    <target name="jar" depends="compileparser">
        <mkdir dir="${jar.dir}"/>
        <jar destfile="${jar.dir}/entityengineparser.jar" basedir="${classes.dir}">
            <manifest>
                <attribute name="Main-Class" value="${main-class}"/>
            </manifest>
        </jar>
    </target>

    <!-- ====================================================================== -->
    <!-- Parsing EntityEngineXML For Timesheet Application                                                         -->
    <!-- ====================================================================== -->

    <target name="runjarforparsingentityenginexml" depends="jar">
        <java jar="${jar.dir}/entityengineparser.jar" fork="true">
            <arg line="${maven.build.resourceDir.0}/entityengine.xml"/>
            <arg line="${maven.build.resourceDir.0}/mysql.database.properties"/>
        </java>
        <delete dir="${build.dir}"/>
    </target>

    <!-- ====================================================================== -->
    <!-- Done Parsing EntityEngineXML For Timesheet Application                                                         -->
    <!-- ====================================================================== -->


</project>
